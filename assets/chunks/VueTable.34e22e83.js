import{d as R,h as k,j as L,o as i,c as d,k as V,F as h,G as E,r as _,a as A,t as F,_ as C}from"./framework.f15d8f8c.js";const I=u=>{const o=[];for(let l=0;l<u.rows.length;l++){const s=u.rows[l],b=[];for(let m=0;m<s.cells.length;m++)s.cells[m].querySelectorAll('a, button, input, select, textarea, [tabindex]:not([tabindex="-1"])').forEach(y=>{b.push({row:l,column:m,element:y})});o.push(b)}return o},D=u=>{for(const o of u)o.setAttribute("tabindex","-1")};function T(u){const o=u.querySelectorAll('a[href], button, input, select, textarea, [tabindex]:not([tabindex="-1"])');return Array.from(o)}function N(u){for(let o=0;o<u.length;o++)for(let l=0;l<u[o].length;l++){const s=u[o][l];if(s!==null&&s!=="")return s}return null}const S=R({__name:"VueTable",props:{fields:{},items:{}},setup(u){const o=k(),l=k([]),s=k(null);L(()=>{m()});const b=()=>{const t=o.value,a=T(t);D(a),a.forEach(e=>{e.removeEventListener("keydown",y)})},m=()=>{const t=o.value;T(t).length&&(l.value=I(t),l.value.length&&(s.value=N(l.value),g(s.value,!0)))},c={Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown"},w=(t,a,e)=>{let n=t,r=a;if(e.key===c.Up||e.key===c.Down){if(e.key===c.Up?n-=1:e.key===c.Down&&(n+=1),n>=0&&n<l.value.length){const f=l.value[n].find(v=>v.column==r);if(f)return f;const p=l.value[n].reduce(function(v,x){return Math.abs(x.column-r)<Math.abs(v.column-r)?x:v});return p||w(n,r,e)}}else if((e.key===c.Left||e.key===c.Right)&&(e.key===c.Left?r-=1:e.key===c.Right&&(r+=1),r>=0&&r<=l.value[n][l.value[n].length-1].column)){const f=l.value[n].find(p=>p.column==r);return f||w(n,r,e)}},y=t=>{if(!s.value)return;const{row:a,column:e}=s.value,n=w(a,e,t);n&&(s.value=n,g(n))},g=(t,a=!1)=>{b(),t.element.setAttribute("tabindex","0"),a||t.element.focus(),t.element.addEventListener("keydown",y)};return(t,a)=>(i(),d("table",{ref_key:"vueTableRef",ref:o},[V("tr",null,[(i(!0),d(h,null,E(t.fields,e=>(i(),d("th",null,[_(t.$slots,`header(${e.key})`,{data:e,header:e.key},()=>[A(F(e.value),1)],!0)]))),256))]),(i(!0),d(h,null,E(t.items,(e,n)=>(i(),d("tr",null,[(i(!0),d(h,null,E(t.fields,(r,f)=>(i(),d("td",null,[_(t.$slots,`cell(${r.key})`,{data:e[r.key],item:e,row:n,column:f},()=>[A(F(e[r.key]),1)],!0)]))),256))]))),256)),_(t.$slots,"tfooter",{},void 0,!0)],512))}});const U=C(S,[["__scopeId","data-v-1dd70c6c"]]);export{U as V};
